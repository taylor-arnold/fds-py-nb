<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>notebook02b – Foundations of Data Science: Notebooks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8b99633e97494cb736d7188ebc41eb6d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./notebook02b.html">Notebook02b</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Foundations of Data Science: Notebooks</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook01a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook01a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook01b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook01b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook02a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook02a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook02b.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Notebook02b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook02c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook02c</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook02d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook02d</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook03a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook03a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook03b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook03b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook03c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook03c</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook03d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook03d</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook03e.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook03e</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook04a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook04a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook04b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook04b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook04c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook04c</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook05a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook05a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook05b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook05b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook06a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook06a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook06b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook06b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook07a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook07a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook07b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook07b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook08a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook08a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook08b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook08b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook09a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook09a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook09b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook09b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook10a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook10a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook10b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook10b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook11a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook11a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook11b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook11b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook12a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook12a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook12b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook12b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook13a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook13a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook13b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook13b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook14a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook14a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook14b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook14b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook15a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook15a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook15b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook15b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook16a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook16a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook16b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook16b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook17a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook17a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook17b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook17b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook18a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook18a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook18b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook18b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook19a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook19a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook19b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook19b</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook20a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook20a</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notebook20b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook20b</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Notebook02b</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setup" class="level3">
<h3 class="anchored" data-anchor-id="setup">Setup</h3>
<p>Run all of the following before starting the notebook.</p>
<div id="41d8857e" class="cell" data-tags="[&quot;noclear&quot;]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> wget <span class="op">-</span>q <span class="op">-</span>nc https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>taylor<span class="op">-</span>arnold<span class="op">/</span>fds<span class="op">-</span>py<span class="op">/</span>refs<span class="op">/</span>heads<span class="op">/</span>main<span class="op">/</span>funs.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="01ba0a2c" class="cell" data-tags="[&quot;noclear&quot;]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> funs <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> polars <span class="im">import</span> col <span class="im">as</span> c</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>theme_set(theme_minimal())</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/taylor-arnold/fds-py-nb/refs/heads/main/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4f3ef77a" class="cell" data-tags="[&quot;noclear&quot;]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>country <span class="op">=</span> pl.read_csv(ub <span class="op">+</span> <span class="st">"data/countries.csv"</span>).drop(c.lang)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="questions" class="level3">
<h3 class="anchored" data-anchor-id="questions">Questions</h3>
<p>In this notebook, we will continue practicing data manipulation techniques using a dataset of countries. The <code>country</code> dataset contains information about various countries including their geographic coordinates (latitude and longitude), life expectancy, happiness scores, population, GDP per capita, and the region of the world they belong to.</p>
<p>Start by finding the country with the highest life expectancy. Your result should show just that one row.</p>
<div id="e863e09d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.lexp, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (1, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SGP"</td>
<td>"Singapore"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>5.871</td>
<td>85.63</td>
<td>1.3</td>
<td>103.8</td>
<td>0.946</td>
<td>137906</td>
<td>null</td>
<td>66.54</td>
<td>145.5</td>
<td>100.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now, select all countries that are located in both the Northern Hemisphere (latitude greater than 0) and the Eastern Hemisphere (longitude greater than 0).</p>
<div id="fb494626" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can also combine into a single filter using `&amp;`</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.lat <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.lon <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (83, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
</tr>
<tr class="even">
<td>"LKA"</td>
<td>"Sri Lanka"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>23.229</td>
<td>78.51</td>
<td>7.0</td>
<td>81.0</td>
<td>0.776</td>
<td>14380</td>
<td>39.3</td>
<td>36.02</td>
<td>83.1</td>
<td>90.77437</td>
</tr>
<tr class="odd">
<td>"SGP"</td>
<td>"Singapore"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>5.871</td>
<td>85.63</td>
<td>1.3</td>
<td>103.8</td>
<td>0.946</td>
<td>137906</td>
<td>null</td>
<td>66.54</td>
<td>145.5</td>
<td>100.0</td>
</tr>
<tr class="even">
<td>"BGR"</td>
<td>"Bulgaria"</td>
<td>"Europe"</td>
<td>"Eastern Europe"</td>
<td>6.715</td>
<td>74.33</td>
<td>42.75</td>
<td>25.5</td>
<td>0.845</td>
<td>36211</td>
<td>40.3</td>
<td>55.9</td>
<td>137.1</td>
<td>86.00395</td>
</tr>
<tr class="odd">
<td>"AFG"</td>
<td>"Afghanistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>43.844</td>
<td>65.11</td>
<td>33.0</td>
<td>66.0</td>
<td>0.496</td>
<td>2093</td>
<td>27.8</td>
<td>14.46</td>
<td>36.1</td>
<td>47.47762</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"THA"</td>
<td>"Thailand"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>71.62</td>
<td>79.78</td>
<td>14.0</td>
<td>101.0</td>
<td>0.798</td>
<td>22696</td>
<td>35.0</td>
<td>62.82</td>
<td>104.6</td>
<td>97.79091</td>
</tr>
<tr class="even">
<td>"ALB"</td>
<td>"Albania"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>2.772</td>
<td>79.67</td>
<td>41.0</td>
<td>20.0</td>
<td>0.81</td>
<td>20362</td>
<td>30.8</td>
<td>54.45</td>
<td>91.9</td>
<td>98.5473</td>
</tr>
<tr class="odd">
<td>"MYS"</td>
<td>"Malaysia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>35.978</td>
<td>76.03</td>
<td>3.7805111</td>
<td>102.314362</td>
<td>0.819</td>
<td>35990</td>
<td>46.2</td>
<td>58.68</td>
<td>118.2</td>
<td>95.69194</td>
</tr>
<tr class="even">
<td>"CYP"</td>
<td>"Cyprus"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>1.371</td>
<td>81.77</td>
<td>35.0</td>
<td>33.0</td>
<td>0.913</td>
<td>55720</td>
<td>31.2</td>
<td>60.71</td>
<td>123.1</td>
<td>99.41781</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Next, select all countries that are located in either the Northern Hemisphere (latitude greater than 0) or the Eastern Hemisphere (longitude greater than 0). This should return more countries than the previous question.</p>
<div id="0c0fcc40" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>((c.lat <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">|</span> (c.lon <span class="op">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (128, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
</tr>
<tr class="even">
<td>"VEN"</td>
<td>"Venezuela, Bolivarian Republic…</td>
<td>"Americas"</td>
<td>"South America"</td>
<td>28.517</td>
<td>76.18</td>
<td>8.0</td>
<td>-67.0</td>
<td>0.709</td>
<td>8899</td>
<td>44.8</td>
<td>57.65</td>
<td>96.8</td>
<td>95.66913</td>
</tr>
<tr class="odd">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
</tr>
<tr class="even">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
</tr>
<tr class="odd">
<td>"LKA"</td>
<td>"Sri Lanka"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>23.229</td>
<td>78.51</td>
<td>7.0</td>
<td>81.0</td>
<td>0.776</td>
<td>14380</td>
<td>39.3</td>
<td>36.02</td>
<td>83.1</td>
<td>90.77437</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"ALB"</td>
<td>"Albania"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>2.772</td>
<td>79.67</td>
<td>41.0</td>
<td>20.0</td>
<td>0.81</td>
<td>20362</td>
<td>30.8</td>
<td>54.45</td>
<td>91.9</td>
<td>98.5473</td>
</tr>
<tr class="even">
<td>"MYS"</td>
<td>"Malaysia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>35.978</td>
<td>76.03</td>
<td>3.7805111</td>
<td>102.314362</td>
<td>0.819</td>
<td>35990</td>
<td>46.2</td>
<td>58.68</td>
<td>118.2</td>
<td>95.69194</td>
</tr>
<tr class="odd">
<td>"SLV"</td>
<td>"El Salvador"</td>
<td>"Americas"</td>
<td>"Central America"</td>
<td>6.366</td>
<td>76.98</td>
<td>13.668889</td>
<td>-88.866111</td>
<td>0.678</td>
<td>12221</td>
<td>38.3</td>
<td>64.82</td>
<td>126.9</td>
<td>86.19786</td>
</tr>
<tr class="even">
<td>"CYP"</td>
<td>"Cyprus"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>1.371</td>
<td>81.77</td>
<td>35.0</td>
<td>33.0</td>
<td>0.913</td>
<td>55720</td>
<td>31.2</td>
<td>60.71</td>
<td>123.1</td>
<td>99.41781</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Select only the countries that are in Africa.</p>
<div id="b250c80b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.region <span class="op">==</span> <span class="st">"Africa"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (37, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
</tr>
<tr class="even">
<td>"GAB"</td>
<td>"Gabon"</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>2.593</td>
<td>68.68</td>
<td>-0.683331</td>
<td>11.5</td>
<td>0.733</td>
<td>19543</td>
<td>38.0</td>
<td>51.04</td>
<td>93.6</td>
<td>49.20331</td>
</tr>
<tr class="odd">
<td>"TZA"</td>
<td>"Tanzania, United Republic of"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>70.546</td>
<td>68.59</td>
<td>-6.306944</td>
<td>34.853889</td>
<td>0.555</td>
<td>3924</td>
<td>40.5</td>
<td>40.42</td>
<td>46.9</td>
<td>26.78297</td>
</tr>
<tr class="even">
<td>"MWI"</td>
<td>"Malawi"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>22.216</td>
<td>66.2</td>
<td>-13.0</td>
<td>34.0</td>
<td>0.517</td>
<td>1689</td>
<td>38.5</td>
<td>32.72</td>
<td>21.0</td>
<td>38.45707</td>
</tr>
<tr class="odd">
<td>"GHA"</td>
<td>"Ghana"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>35.064</td>
<td>67.41</td>
<td>7.9465</td>
<td>-1.0232</td>
<td>0.628</td>
<td>7404</td>
<td>43.5</td>
<td>42.98</td>
<td>68.4</td>
<td>22.67011</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"ETH"</td>
<td>"Ethiopia"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>135.472</td>
<td>70.68</td>
<td>9.0</td>
<td>40.0</td>
<td>0.497</td>
<td>3107</td>
<td>35.0</td>
<td>40.93</td>
<td>7.6</td>
<td>8.04716</td>
</tr>
<tr class="even">
<td>"CMR"</td>
<td>"Cameroon"</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>29.879</td>
<td>64.52</td>
<td>5.133333</td>
<td>12.65</td>
<td>0.588</td>
<td>5107</td>
<td>46.6</td>
<td>49.46</td>
<td>43.9</td>
<td>41.90133</td>
</tr>
<tr class="odd">
<td>"LBR"</td>
<td>"Liberia"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>5.731</td>
<td>67.61</td>
<td>6.533333</td>
<td>-9.75</td>
<td>0.51</td>
<td>1752</td>
<td>35.3</td>
<td>44.94</td>
<td>38.7</td>
<td>19.63094</td>
</tr>
<tr class="even">
<td>"MAR"</td>
<td>"Morocco"</td>
<td>"Africa"</td>
<td>"Northern Africa"</td>
<td>38.431</td>
<td>74.71</td>
<td>32.0</td>
<td>-6.0</td>
<td>0.71</td>
<td>9583</td>
<td>39.5</td>
<td>44.87</td>
<td>98.5</td>
<td>84.47591</td>
</tr>
<tr class="odd">
<td>"GMB"</td>
<td>"Gambia"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>2.822</td>
<td>68.16</td>
<td>13.5</td>
<td>-15.5</td>
<td>0.524</td>
<td>3199</td>
<td>null</td>
<td>46.91</td>
<td>76.7</td>
<td>46.90722</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Now, select countries that are in either Africa or Europe. Note: Do this without using the <code>|</code> (or) operator.</p>
<div id="539a7305" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.region.is_in([<span class="st">"Africa"</span>, <span class="st">"Europe"</span>]))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (75, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
</tr>
<tr class="even">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
</tr>
<tr class="odd">
<td>"GAB"</td>
<td>"Gabon"</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>2.593</td>
<td>68.68</td>
<td>-0.683331</td>
<td>11.5</td>
<td>0.733</td>
<td>19543</td>
<td>38.0</td>
<td>51.04</td>
<td>93.6</td>
<td>49.20331</td>
</tr>
<tr class="even">
<td>"BGR"</td>
<td>"Bulgaria"</td>
<td>"Europe"</td>
<td>"Eastern Europe"</td>
<td>6.715</td>
<td>74.33</td>
<td>42.75</td>
<td>25.5</td>
<td>0.845</td>
<td>36211</td>
<td>40.3</td>
<td>55.9</td>
<td>137.1</td>
<td>86.00395</td>
</tr>
<tr class="odd">
<td>"TZA"</td>
<td>"Tanzania, United Republic of"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>70.546</td>
<td>68.59</td>
<td>-6.306944</td>
<td>34.853889</td>
<td>0.555</td>
<td>3924</td>
<td>40.5</td>
<td>40.42</td>
<td>46.9</td>
<td>26.78297</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"LUX"</td>
<td>"Luxembourg"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>0.68</td>
<td>83.82</td>
<td>49.77</td>
<td>6.13</td>
<td>0.922</td>
<td>131038</td>
<td>34.9</td>
<td>70.16</td>
<td>143.3</td>
<td>97.60054</td>
</tr>
<tr class="even">
<td>"LTU"</td>
<td>"Lithuania"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>2.83</td>
<td>77.19</td>
<td>55.2</td>
<td>24.0</td>
<td>0.895</td>
<td>49761</td>
<td>35.3</td>
<td>65.53</td>
<td>157.9</td>
<td>92.73568</td>
</tr>
<tr class="odd">
<td>"MNE"</td>
<td>"Montenegro"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>0.633</td>
<td>76.92</td>
<td>42.766667</td>
<td>19.216667</td>
<td>0.862</td>
<td>29492</td>
<td>29.4</td>
<td>58.13</td>
<td>185.1</td>
<td>96.657</td>
</tr>
<tr class="even">
<td>"GMB"</td>
<td>"Gambia"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>2.822</td>
<td>68.16</td>
<td>13.5</td>
<td>-15.5</td>
<td>0.524</td>
<td>3199</td>
<td>null</td>
<td>46.91</td>
<td>76.7</td>
<td>46.90722</td>
</tr>
<tr class="odd">
<td>"ALB"</td>
<td>"Albania"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>2.772</td>
<td>79.67</td>
<td>41.0</td>
<td>20.0</td>
<td>0.81</td>
<td>20362</td>
<td>30.8</td>
<td>54.45</td>
<td>91.9</td>
<td>98.5473</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Find the happiest country in each region. That is, for each region, return only the country with the highest happiness score.</p>
<div id="4ffbbd63" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    .sort(c.happy, descending<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 14)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Europe"</td>
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
</tr>
<tr class="even">
<td>"Oceania"</td>
<td>"AUS"</td>
<td>"Australia"</td>
<td>"Australia and New Zealand"</td>
<td>26.974</td>
<td>83.79</td>
<td>-25.0</td>
<td>133.0</td>
<td>0.958</td>
<td>61943</td>
<td>32.4</td>
<td>70.25</td>
<td>101.6</td>
<td>99.99923</td>
</tr>
<tr class="odd">
<td>"Americas"</td>
<td>"CRI"</td>
<td>"Costa Rica"</td>
<td>"Central America"</td>
<td>5.153</td>
<td>81.33</td>
<td>10.0</td>
<td>-84.0</td>
<td>0.833</td>
<td>28390</td>
<td>49.3</td>
<td>73.84</td>
<td>68.7</td>
<td>97.47361</td>
</tr>
<tr class="even">
<td>"Africa"</td>
<td>"LBY"</td>
<td>"Libya"</td>
<td>"Northern Africa"</td>
<td>7.459</td>
<td>77.15</td>
<td>27.0</td>
<td>17.0</td>
<td>0.721</td>
<td>14636</td>
<td>null</td>
<td>59.7</td>
<td>167.7</td>
<td>92.10514</td>
</tr>
<tr class="odd">
<td>"Asia"</td>
<td>"KWT"</td>
<td>"Kuwait"</td>
<td>"Western Asia"</td>
<td>5.026</td>
<td>82.62</td>
<td>29.166667</td>
<td>47.6</td>
<td>0.852</td>
<td>46572</td>
<td>null</td>
<td>71.3</td>
<td>135.2</td>
<td>100.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The population column in our dataset is given in millions. Create a new column that contains the raw population (i.e., the actual number of people rather than millions of people).</p>
<div id="0a78ba16" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Python allows, optionally, to use underscores in a number</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># "as visual separators for digit grouping purposes" (PEP 515)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># these do not affect the subsequent code but make it much</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># easier to read large numbers</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        pop_raw <span class="op">=</span> c.pop <span class="op">*</span> <span class="dv">1_000_000</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">pop_raw</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"SEN"</td>
<td>"Senegal"</td>
<td>"Africa"</td>
<td>"Western Africa"</td>
<td>18.932</td>
<td>70.43</td>
<td>14.366667</td>
<td>-14.283333</td>
<td>0.53</td>
<td>4871</td>
<td>38.1</td>
<td>50.93</td>
<td>66.0</td>
<td>54.93987</td>
<td>1.8932e7</td>
</tr>
<tr class="even">
<td>"VEN"</td>
<td>"Venezuela, Bolivarian Republic…</td>
<td>"Americas"</td>
<td>"South America"</td>
<td>28.517</td>
<td>76.18</td>
<td>8.0</td>
<td>-67.0</td>
<td>0.709</td>
<td>8899</td>
<td>44.8</td>
<td>57.65</td>
<td>96.8</td>
<td>95.66913</td>
<td>2.8517e7</td>
</tr>
<tr class="odd">
<td>"FIN"</td>
<td>"Finland"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>5.623</td>
<td>82.84</td>
<td>65.0</td>
<td>27.0</td>
<td>0.948</td>
<td>57574</td>
<td>27.7</td>
<td>76.99</td>
<td>156.4</td>
<td>99.44798</td>
<td>5.623e6</td>
</tr>
<tr class="even">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>3.47276e8</td>
</tr>
<tr class="odd">
<td>"LKA"</td>
<td>"Sri Lanka"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>23.229</td>
<td>78.51</td>
<td>7.0</td>
<td>81.0</td>
<td>0.776</td>
<td>14380</td>
<td>39.3</td>
<td>36.02</td>
<td>83.1</td>
<td>90.77437</td>
<td>2.3229e7</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"ALB"</td>
<td>"Albania"</td>
<td>"Europe"</td>
<td>"Southern Europe"</td>
<td>2.772</td>
<td>79.67</td>
<td>41.0</td>
<td>20.0</td>
<td>0.81</td>
<td>20362</td>
<td>30.8</td>
<td>54.45</td>
<td>91.9</td>
<td>98.5473</td>
<td>2.772e6</td>
</tr>
<tr class="even">
<td>"MYS"</td>
<td>"Malaysia"</td>
<td>"Asia"</td>
<td>"South-eastern Asia"</td>
<td>35.978</td>
<td>76.03</td>
<td>3.7805111</td>
<td>102.314362</td>
<td>0.819</td>
<td>35990</td>
<td>46.2</td>
<td>58.68</td>
<td>118.2</td>
<td>95.69194</td>
<td>3.5978e7</td>
</tr>
<tr class="odd">
<td>"SLV"</td>
<td>"El Salvador"</td>
<td>"Americas"</td>
<td>"Central America"</td>
<td>6.366</td>
<td>76.98</td>
<td>13.668889</td>
<td>-88.866111</td>
<td>0.678</td>
<td>12221</td>
<td>38.3</td>
<td>64.82</td>
<td>126.9</td>
<td>86.19786</td>
<td>6.366e6</td>
</tr>
<tr class="even">
<td>"CYP"</td>
<td>"Cyprus"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>1.371</td>
<td>81.77</td>
<td>35.0</td>
<td>33.0</td>
<td>0.913</td>
<td>55720</td>
<td>31.2</td>
<td>60.71</td>
<td>123.1</td>
<td>99.41781</td>
<td>1.371e6</td>
</tr>
<tr class="odd">
<td>"PAK"</td>
<td>"Pakistan"</td>
<td>"Asia"</td>
<td>"Southern Asia"</td>
<td>255.22</td>
<td>66.71</td>
<td>30.0</td>
<td>71.0</td>
<td>0.544</td>
<td>5717</td>
<td>29.6</td>
<td>45.49</td>
<td>49.8</td>
<td>61.92651</td>
<td>2.5522e8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The GDP per capita of the United States (in the dataset) is 78_389. Compute the absolute distance using <code>.abs</code> of each country’s GDP to this value and sort the dataset by the distance.</p>
<div id="40f5a013" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        gdp_dist <span class="op">=</span> (c.gdp <span class="op">-</span> <span class="dv">78_389</span>).<span class="bu">abs</span>()</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    .sort(c.gdp_dist)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (135, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">gdp_dist</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Americas"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>0</td>
</tr>
<tr class="even">
<td>"DNK"</td>
<td>"Denmark"</td>
<td>"Europe"</td>
<td>"Northern Europe"</td>
<td>6.003</td>
<td>82.02</td>
<td>56.0</td>
<td>10.0</td>
<td>0.962</td>
<td>77337</td>
<td>27.7</td>
<td>75.04</td>
<td>115.7</td>
<td>99.59723</td>
<td>1052</td>
</tr>
<tr class="odd">
<td>"NLD"</td>
<td>"Netherlands, Kingdom of the"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>18.347</td>
<td>82.55</td>
<td>52.366667</td>
<td>4.883333</td>
<td>0.955</td>
<td>73384</td>
<td>null</td>
<td>72.55</td>
<td>114.4</td>
<td>97.71353</td>
<td>5005</td>
</tr>
<tr class="even">
<td>"ARE"</td>
<td>"United Arab Emirates"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>11.346</td>
<td>74.94</td>
<td>24.4</td>
<td>54.3</td>
<td>0.94</td>
<td>72660</td>
<td>26.0</td>
<td>67.28</td>
<td>157.5</td>
<td>99.10363</td>
<td>5729</td>
</tr>
<tr class="odd">
<td>"CHE"</td>
<td>"Switzerland"</td>
<td>"Europe"</td>
<td>"Western Europe"</td>
<td>8.967</td>
<td>84.85</td>
<td>46.798562</td>
<td>8.231973</td>
<td>0.97</td>
<td>84311</td>
<td>33.1</td>
<td>69.69</td>
<td>123.2</td>
<td>99.89987</td>
<td>5922</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>"YEM"</td>
<td>"Yemen"</td>
<td>"Asia"</td>
<td>"Western Asia"</td>
<td>41.774</td>
<td>69.27</td>
<td>15.5</td>
<td>48.0</td>
<td>0.47</td>
<td>1722</td>
<td>35.9</td>
<td>35.32</td>
<td>41.4</td>
<td>52.61741</td>
<td>76667</td>
</tr>
<tr class="even">
<td>"MDG"</td>
<td>"Madagascar"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>32.741</td>
<td>67.03</td>
<td>-20.0</td>
<td>47.0</td>
<td>0.487</td>
<td>1720</td>
<td>42.6</td>
<td>44.33</td>
<td>34.8</td>
<td>12.1276</td>
<td>76669</td>
</tr>
<tr class="odd">
<td>"MWI"</td>
<td>"Malawi"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>22.216</td>
<td>66.2</td>
<td>-13.0</td>
<td>34.0</td>
<td>0.517</td>
<td>1689</td>
<td>38.5</td>
<td>32.72</td>
<td>21.0</td>
<td>38.45707</td>
<td>76700</td>
</tr>
<tr class="even">
<td>"COD"</td>
<td>"Congo, Democratic Republic of …</td>
<td>"Africa"</td>
<td>"Middle Africa"</td>
<td>112.832</td>
<td>66.25</td>
<td>-2.88</td>
<td>23.656111</td>
<td>0.522</td>
<td>1566</td>
<td>42.1</td>
<td>33.83</td>
<td>17.2</td>
<td>17.04284</td>
<td>76823</td>
</tr>
<tr class="odd">
<td>"MOZ"</td>
<td>"Mozambique"</td>
<td>"Africa"</td>
<td>"Eastern Africa"</td>
<td>35.632</td>
<td>60.06</td>
<td>-19.0</td>
<td>35.0</td>
<td>0.493</td>
<td>1531</td>
<td>54.0</td>
<td>57.04</td>
<td>31.4</td>
<td>30.56033</td>
<td>76858</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Find the country in each region that has the closest GDP per capita to the United States. Note: You will probably want to first copy your answer above and make changes rather than starting from scratch.</p>
<div id="28b007b2" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        gdp_dist <span class="op">=</span> (c.gdp <span class="op">-</span> <span class="dv">78_389</span>).<span class="bu">abs</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    .sort(c.gdp_dist)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">1</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">gdp_dist</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Americas"</td>
<td>"USA"</td>
<td>"United States of America"</td>
<td>"Northern America"</td>
<td>347.276</td>
<td>79.83</td>
<td>39.828175</td>
<td>-98.5795</td>
<td>0.938</td>
<td>78389</td>
<td>47.7</td>
<td>65.21</td>
<td>91.7</td>
<td>99.72235</td>
<td>0</td>
</tr>
<tr class="even">
<td>"Europe"</td>
<td>"DNK"</td>
<td>"Denmark"</td>
<td>"Northern Europe"</td>
<td>6.003</td>
<td>82.02</td>
<td>56.0</td>
<td>10.0</td>
<td>0.962</td>
<td>77337</td>
<td>27.7</td>
<td>75.04</td>
<td>115.7</td>
<td>99.59723</td>
<td>1052</td>
</tr>
<tr class="odd">
<td>"Oceania"</td>
<td>"AUS"</td>
<td>"Australia"</td>
<td>"Australia and New Zealand"</td>
<td>26.974</td>
<td>83.79</td>
<td>-25.0</td>
<td>133.0</td>
<td>0.958</td>
<td>61943</td>
<td>32.4</td>
<td>70.25</td>
<td>101.6</td>
<td>99.99923</td>
<td>16446</td>
</tr>
<tr class="even">
<td>"Africa"</td>
<td>"MUS"</td>
<td>"Mauritius"</td>
<td>"Eastern Africa"</td>
<td>1.268</td>
<td>76.35</td>
<td>-20.2</td>
<td>57.5</td>
<td>0.806</td>
<td>28927</td>
<td>36.8</td>
<td>57.59</td>
<td>92.8</td>
<td>95.45876</td>
<td>49462</td>
</tr>
<tr class="odd">
<td>"Asia"</td>
<td>"ARE"</td>
<td>"United Arab Emirates"</td>
<td>"Western Asia"</td>
<td>11.346</td>
<td>74.94</td>
<td>24.4</td>
<td>54.3</td>
<td>0.94</td>
<td>72660</td>
<td>26.0</td>
<td>67.28</td>
<td>157.5</td>
<td>99.10363</td>
<td>5729</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The United States is, of course, the closest to itself in “Americas”. Finally, modify the previous code to remove the United States from the data so that we can see what other country it is closest to in its own region. Note: When we say “modify” in these notes, that means to copy and then modify; don’t change the original code itself.</p>
<div id="53fa4147" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    country</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(c.iso <span class="op">!=</span> <span class="st">"USA"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    .with_columns(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        gdp_dist <span class="op">=</span> (c.gdp <span class="op">-</span> <span class="dv">78_389</span>).<span class="bu">abs</span>()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    .sort(c.gdp_dist)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    .group_by(c.region)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">1</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 15)</small>
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">region</th>
<th data-quarto-table-cell-role="th">iso</th>
<th data-quarto-table-cell-role="th">full_name</th>
<th data-quarto-table-cell-role="th">subregion</th>
<th data-quarto-table-cell-role="th">pop</th>
<th data-quarto-table-cell-role="th">lexp</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">hdi</th>
<th data-quarto-table-cell-role="th">gdp</th>
<th data-quarto-table-cell-role="th">gini</th>
<th data-quarto-table-cell-role="th">happy</th>
<th data-quarto-table-cell-role="th">cellphone</th>
<th data-quarto-table-cell-role="th">water_access</th>
<th data-quarto-table-cell-role="th">gdp_dist</th>
</tr>
<tr class="even">
<th>str</th>
<th>str</th>
<th>str</th>
<th>str</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>f64</th>
<th>i64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>"Europe"</td>
<td>"DNK"</td>
<td>"Denmark"</td>
<td>"Northern Europe"</td>
<td>6.003</td>
<td>82.02</td>
<td>56.0</td>
<td>10.0</td>
<td>0.962</td>
<td>77337</td>
<td>27.7</td>
<td>75.04</td>
<td>115.7</td>
<td>99.59723</td>
<td>1052</td>
</tr>
<tr class="even">
<td>"Oceania"</td>
<td>"AUS"</td>
<td>"Australia"</td>
<td>"Australia and New Zealand"</td>
<td>26.974</td>
<td>83.79</td>
<td>-25.0</td>
<td>133.0</td>
<td>0.958</td>
<td>61943</td>
<td>32.4</td>
<td>70.25</td>
<td>101.6</td>
<td>99.99923</td>
<td>16446</td>
</tr>
<tr class="odd">
<td>"Americas"</td>
<td>"CAN"</td>
<td>"Canada"</td>
<td>"Northern America"</td>
<td>40.127</td>
<td>83.15</td>
<td>56.0</td>
<td>-109.0</td>
<td>0.939</td>
<td>58422</td>
<td>33.3</td>
<td>68.41</td>
<td>75.5</td>
<td>98.92568</td>
<td>19967</td>
</tr>
<tr class="even">
<td>"Africa"</td>
<td>"MUS"</td>
<td>"Mauritius"</td>
<td>"Eastern Africa"</td>
<td>1.268</td>
<td>76.35</td>
<td>-20.2</td>
<td>57.5</td>
<td>0.806</td>
<td>28927</td>
<td>36.8</td>
<td>57.59</td>
<td>92.8</td>
<td>95.45876</td>
<td>49462</td>
</tr>
<tr class="odd">
<td>"Asia"</td>
<td>"ARE"</td>
<td>"United Arab Emirates"</td>
<td>"Western Asia"</td>
<td>11.346</td>
<td>74.94</td>
<td>24.4</td>
<td>54.3</td>
<td>0.94</td>
<td>72660</td>
<td>26.0</td>
<td>67.28</td>
<td>157.5</td>
<td>99.10363</td>
<td>5729</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>And there we go, already a fairly intricate manipulation of the data with just a few simple functions!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>